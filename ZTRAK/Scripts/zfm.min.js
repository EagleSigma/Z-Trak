function joinGroup(){var n=$("#currentUserInfo").attr("data-teamname"),t=$("#currentUserInfo").attr("data-username");pickupChannel.server.joinGroup(n);console.log("User: "+t+" has joined group: "+n)}function activateViewMap(){getLocationStartModel()}function activateMapRefresh(){$(document).on("click","#update-map",null,function(){var n=$("#update-map").hasClass("btn-success");n?($("#update-map").addClass("btn-primary"),$("#update-map").removeClass("btn-success")):($("#update-map").addClass("btn-success"),$("#update-map").removeClass("btn-primary"))})}function activateAddLocation(){$(".navbar-collapse").removeClass("in");resizeNavNow();globalDisplayMode="edit";Microsoft.Maps.loadModule("Microsoft.Maps.Themes.BingTheme",{callback:function(){map=new Microsoft.Maps.Map(document.getElementById("myMap"),{credentials:"Alsg6_wydyNTX7BpLWntLwloWLn5m3PEAuf0FjJ_kGOrtLg-PPiXSi4Ba4qzAf7F",mapTypeId:window.Microsoft.Maps.MapTypeId.road,theme:new Microsoft.Maps.Themes.BingTheme,zoom:5,showScalebar:!0,enableClickableLogo:!1,enableSearchLogo:!1,showCopyright:!1,showDashboard:!1,tileBuffer:4,showMapTypeSelector:!1})}});setTimeout(function(){var n=new Microsoft.Maps.Location(38.442726135253906,-119.32534790039063);map.setView({center:n,zoom:6})},950);$("#addLocation").modal("show")}function activateFindLocationGPS(){$(document).on("click",".find-gps",null,function(){var f=$("#loc-gps-name").val(),n=$("#address-gps").val(),t=$("#city-gps").val(),i=$("#state-gps").val(),r=$("#zip-gps").val(),u=n+", "+t+", "+i+","+r;if(u.length<3){$.ionSound.play("alert");return}map.getCredentials(callSearchService)});$(document).on("click",".save-gps",null,function(){var t=$("#loc-gps-name").val(),i=locSearchResult.resourceSets[0].resources[0].address.addressLine,r=locSearchResult.resourceSets[0].resources[0].address.locality,u=locSearchResult.resourceSets[0].resources[0].address.adminDistrict,f=locSearchResult.resourceSets[0].resources[0].address.postalCode,n=t+" , "+i+" , "+r+" , "+u+" , "+f+" , "+locSearchResult.resourceSets[0].resources[0].point.coordinates[0]+" , "+locSearchResult.resourceSets[0].resources[0].point.coordinates[1];if(n.length<3){$.ionSound.play("alert");return}saveLocation(n);globalDisplayMode="display"});$(document).on("click",".traffic-show",null,function(){Microsoft.Maps.loadModule("Microsoft.Maps.Traffic",{callback:trafficModuleLoaded});$("#show-traffic").hasClass("btn-info")?Microsoft.Maps.loadModule("Microsoft.Maps.Traffic",{callback:function(){trafficLayer=new Microsoft.Maps.Traffic.TrafficLayer(map);$("#show-traffic").removeClass("btn-info");$("#show-traffic").addClass("btn-success");trafficLayer.show()}}):($("#show-traffic").addClass("btn-info"),$("#show-traffic").removeClass("btn-success"),trafficLayer.hide())})}function trafficModuleLoaded(){console.log("Traffic Loaded")}function callSearchService(n){var s=$("#loc-gps-name").val(),i=$("#address-gps").val(),r=$("#city-gps").val(),u=$("#state-gps").val(),f=$("#zip-gps").val(),e=i+","+r+","+u+f,o="http://dev.virtualearth.net/REST/v1/Locations/"+e+"?output=json&jsonp=searchServiceCallback&key="+n,t=document.createElement("script");t.type="text/javascript";t.src=o;document.getElementById("myMap").appendChild(t)}function searchServiceCallback(n){var e,i;if(n&&n.resourceSets&&n.resourceSets.length>0&&n.resourceSets[0].resources&&n.resourceSets[0].resources.length>0){var t=n.resourceSets[0].resources[0].bbox,u=Microsoft.Maps.LocationRect.fromLocations(new Microsoft.Maps.Location(t[0],t[1]),new Microsoft.Maps.Location(t[2],t[3])),f=new Microsoft.Maps.Location(n.resourceSets[0].resources[0].point.coordinates[0],n.resourceSets[0].resources[0].point.coordinates[1]);map.setView({bounds:u});e=f;locSearchResult=n;var v=$("#currentUserInfo").attr("data-teamname"),r="../Content/TeamIcons/Flag_Processed.png",o=$("#loc-gps-name").val().toUpperCase(),s=locSearchResult.resourceSets[0].resources[0].address.addressLine,h=locSearchResult.resourceSets[0].resources[0].address.locality,c=locSearchResult.resourceSets[0].resources[0].address.adminDistrict,l=locSearchResult.resourceSets[0].resources[0].address.postalCode,a=s+", "+h+", "+c+" "+l;iconStartUrl=r;pinOptions={text:"1",icon:r,width:39,height:39,textOffset:{x:1,y:5}};i=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(n.resourceSets[0].resources[0].point.coordinates[0],n.resourceSets[0].resources[0].point.coordinates[1]),pinOptions);map.entities.push(i);map.entities.push(new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(n.resourceSets[0].resources[0].point.coordinates[0],n.resourceSets[0].resources[0].point.coordinates[1]),{title:o,description:a,pushpin:i}))}else typeof response=="undefined"||response==null?bootbox.alert("Location not found. Update Information and try again."):(typeof response!="undefined"&&response&&n&&n.errorDetails&&alert(response.errorDetails[0]),bootbox.alert("Error Finding Location"))}function teamPinNumber(n){switch(n){case"Team East Bay":return"Team1.png";case"Team Fresno":return"Team2.png";case"Team Fresno":return"Team3.png";case"Team North Bay":return"Team4.png";case"Team San Francisco":return"Team5.png";case"Team San Jose":return"Team6.png";case"Team Chico":return"Team7.png";case"Team Central Coast":return"Team8.png";case"Team Sacramento":return"Team9.png";case"Team Modesto":return"Team10.png";case"Team Sacramento":return"Team11.png";case"Team Napa":return"Team12.png";case"Team Quig-Hoogie":return"Team13.png";case"Team Reno":return"Team14.png";case"Team Santa Cruz-Mont":return"Team15.png"}}function saveLocation(n,t){var i={};(typeof t=="undefined"||t==null)&&(t="no");i=n!==""?{locInfo:n+" , "+t}:{locInfo:"NA"};$.ajax({url:"/Pickup/SaveLocation",cache:!1,data:i,type:"POST"}).done(function(n){var t=$("#loc-gps-name").val(),i;n.answer==="saved!"?(console.log("Location save response: "+n),i=bootbox.alert("<h3>Location: <span style='color: darkOrange; text-align: center; margin-top:5px' > "+t+"<\/span>  saved.  <\/h3> "),setTimeout(function(){i.modal("hide")},3e3)):n.answer==="duplicate"&&bootbox.confirm("<h3>Location: <span style='color: darkOrange; text-align: center; margin-top:5px' > "+t+"<\/span>  already exists.  <\/h3> <h4> Overwrite exiting name? <\/h4>",function(n){if(n===!0){var t=$("#loc-gps-name").val(),i=locSearchResult.resourceSets[0].resources[0].address.addressLine,r=locSearchResult.resourceSets[0].resources[0].address.locality,u=locSearchResult.resourceSets[0].resources[0].address.adminDistrict,f=locSearchResult.resourceSets[0].resources[0].address.postalCode,e=t+" , "+i+" , "+r+" , "+u+" , "+f+" , "+locSearchResult.resourceSets[0].resources[0].point.coordinates[0]+" , "+locSearchResult.resourceSets[0].resources[0].point.coordinates[1];saveLocation(e,"yes")}})}).complete(function(){console.log("Location save complete.")}).error(function(){var n=$("#loc-gps-name").val();bootbox.alert("Error saving location: "+n+"  to server.")})}function addPushpins(){var u="../Content/TeamIcons/BlueStart.png",t="../Content/TeamIcons/BlueStart4.png",f="../Content/TeamIcons/BlueStart5.png",r=viewModel.locationsStartCollection,e=viewModel.locationsEndCollection,n=r().length,i=$(".pickup-count-map");n===1?i.html(n+" Pickup"):n>=1?i.html(n+" Pickups"):n===0&&i.html("No Active Pickups");ko.utils.arrayForEach(r(),function(n){var h=new Microsoft.Maps.Location(n.Latitude(),n.Longitude()),o,s,e;map.setView({center:h,zoom:6});var c=n.PickupNumber(),r=c.toString().length,i={};n.Team()===null&&n.Team("n/a");n.SalesRep()===null&&n.SalesRep("n/a");n.WhContact()===null&&n.WhContact("n/a");n.Courier()===null&&n.Courier("n/a");n.Status()===null&&n.Status("n/a");o=n.PickupNumber()+" - "+n.Location().toUpperCase();s="Notes: "+n.Notes()+"<br/> Team: "+n.Team()+" |  Rep: "+n.SalesRep()+" | SC: "+n.WhContact()+" | Courier: "+n.Courier()+" |  Status: "+n.Status();r<=3?(iconStartUrl=u,i={text:""+n.PickupNumber(),icon:iconStartUrl,width:39,height:39,textOffset:{x:1,y:5}}):r<=4?(iconStartUrl=t,i={icon:t,width:52,height:52,textOffset:{x:0,y:10},text:""+n.PickupNumber()}):r<=5&&(iconStartUrl=t,i={icon:f,width:82,height:62,textOffset:{x:-10,y:15},text:""+n.PickupNumber()});e=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(n.Latitude(),n.Longitude()),i);map.entities.push(e);map.entities.push(new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(n.Latitude(),n.Longitude()),{title:o,description:s,pushpin:e}))});return}function getLocationStartModel(){$(".navbar-collapse").removeClass("in");resizeNavNow();var n=$(window).height();$("#mapDiv").height(n-120+"px");$("#mapView").modal("show");setTimeout(function(){$("#mapView").find(".modal-dialog").css({width:"auto",height:"auto","max-height":"100%","margin-top":"10px"})},2e3);typeof map!="undefined"&&map!==null&&(map.dispose(),map=null);navigator.userAgent.match(/(iPod|iPhone)/)?Microsoft.Maps.loadModule("Microsoft.Maps.Themes.BingTheme",{callback:function(){map=new Microsoft.Maps.Map(document.getElementById("mapDiv"),{credentials:"Alsg6_wydyNTX7BpLWntLwloWLn5m3PEAuf0FjJ_kGOrtLg-PPiXSi4Ba4qzAf7F",theme:new Microsoft.Maps.Themes.BingTheme,zoom:6,tileBuffer:4,mapTypeId:window.Microsoft.Maps.MapTypeId.road,enableClickableLogo:!1,enableSearchLogo:!1,showCopyright:!1,showDashboard:!1,showMapTypeSelector:!1})}}):Microsoft.Maps.loadModule("Microsoft.Maps.Themes.BingTheme",{callback:function(){map=new Microsoft.Maps.Map(document.getElementById("mapDiv"),{credentials:"Alsg6_wydyNTX7BpLWntLwloWLn5m3PEAuf0FjJ_kGOrtLg-PPiXSi4Ba4qzAf7F",theme:new Microsoft.Maps.Themes.BingTheme,zoom:6,tileBuffer:4,mapTypeId:window.Microsoft.Maps.MapTypeId.road,enableClickableLogo:!1,enableSearchLogo:!1,showCopyright:!1,showDashboard:!0,showMapTypeSelector:!0})}});setTimeout(function(){var n=new Microsoft.Maps.Location(38.442726135253906,-119.32534790039063);map.setView({center:n,zoom:6})},950);getLocations("start")}function getLocationEndModel(){getLocations("end")}function getPickups(n){var t,i,r;$(".navbar-collapse").removeClass("in");resizeNavNow();gDataRequest="starting";console.log("Data Request For Pickups: "+gDataRequest);t={};t=n==="completed"?{requestType:"completed"}:{requestType:"standard"};i=getUrlParameter("smsAlert");i==="yes"&&(r={"z-trak":!0},history.pushState(r,"Z-Trak","/Pickup"),t={requestType:"completed"});$("#pullPickups").addClass("fa-spin");$.ajax({url:"/Pickup/GetPickups",cache:!1,data:t,type:"GET"}).done(function(n){globaltotalPickups=n.length;console.log("Retrieved "+globaltotalPickups+" Pickups From Server.");viewModel.pickupCollection?ko.mapping.fromJS(n,viewModel.pickupCollection):(viewModel.pickupCollection=ko.mapping.fromJS(n),ko.applyBindings(viewModel))}).complete(function(){resetElapsedTimer();formatAllDates();convertLocTile2Uppercase();searchPickupsNow();priorityAlert();setTimeout(function(){var t,i;$("#pullPickups").removeClass("fa-spin");gDataRequest="done";scrollAfterPhotoUpload();resizeNavNow();t=localStorage.getItem("showLabels");t==="no"&&toggleFieldLabels();n==="completed"&&setTimeout(function(){var n=$(".navbar").height()-40;$("html,body").animate({scrollTop:n},800)},1e3);i=$("#update-map").hasClass("btn-success");i&&getLocationStartModel();console.log("Data Request For Pickups: "+gDataRequest)},1e3)}).error(function(){bootbox.alert("Error retrieving data from server...")})}function getLocations(n){$(".navbar-collapse").removeClass("in");resizeNavNow();console.log("Data Request For Locations: "+gDataRequest);var t={};t=n==="start"?{requestType:"start"}:{requestType:"end"};$("#pullPickups").addClass("fa-spin");$.ajax({url:"/Pickup/GetLocations",cache:!1,data:t,type:"GET"}).done(function(t){console.log("Retrieved "+t.length+" Locations From Server.");n=="start"?viewModel.locationsStartCollection=ko.mapping.fromJS(t):n==="end"&&(viewModel.locationsEndCollection=ko.mapping.fromJS(t))}).complete(function(){$("#pullPickups").removeClass("fa-spin");resizeNavNow();console.log("Data request for locations done.");n=="start"?getLocationEndModel():n==="end"&&addPushpins()}).error(function(n){bootbox.alert("Error retrieving locations from server: "+n.messageS)})}function removePickup(n){$.ajax({url:"/Pickup/RemovePickup",cache:!1,type:"GET",data:{pickupID:n},success:function(n){n=="success"&&getPickups()}})}function activateEditButton(){$(document).on("click",".zfm-edit",null,function(){var n=ko.dataFor(this),r=ko.mapping.fromJS(ko.mapping.toJS(n)),t,i;gPickupUpdateBackups.push(r);t=$("#pu"+n.PickupNumber()).offset().top;i=$("#currentUserInfo").attr("data-userrole").toLocaleLowerCase();i.indexOf("courier")>=0||i.indexOf("warehouse")>=0?n.Mode("editAdmin"):n.Mode("edit");globalDisplayMode="edit";setTimeout(function(){var i,r;formatAllDates();i=$("#pu"+n.PickupNumber()).offset().top;typeof t!="undefined"&&typeof i!="undefined"&&t!==i&&(r="#pu"+n.PickupNumber(),scrollToID(r,750,"go"))},250)})}function activatePhototButton(){$(document).on("click",".zfm-photo",null,function(){var n=ko.dataFor(this),t,i;n.Mode("photo");n.Items().length===0&&(t=$("#currentUserInfo").attr("data-fullname"),i={ID:ko.observable("0"),Description:ko.observable("PHOTO UPLOAD"),Qty:ko.observable("1"),Notes:ko.observable(""),PickupReff:ko.observable(n.PickupNumber()),AddedBy:ko.observable(t),AddedDate:ko.observable(moment(new Date).format("l  LT")),Picture1:ko.observable("none"),Picture2:ko.observable("")},n.Items().push(i),ko.mapping.fromJS(viewModel.pickupCollection,viewModel.pickupCollection));setTimeout(function(){sendPhotos();formatAllDates();checkFileB4Uoload();var n=localStorage.getItem("showLabels");n==="no"&&toggleFieldLabels()},950)})}function activateCancelButton(){$(document).on("click",".zfm-cancel",null,function(){var n=ko.dataFor(this),i=$("#pu"+n.PickupNumber()).offset().top,t=n.PickupNumber();bootbox.confirm("<h3>Cancel Changes to Pickup #: <span style='color: darkOrange'>"+t+"<\/span>?<\/h3>",function(i){var o,u,f,l,r,s,h,e,c;if(i===!0){for(t==="NEW"&&(o=ko.utils.arrayFirst(viewModel.pickupCollection(),function(n){return n.PickupNumber()===t}),ko.utils.arrayRemoveItem(viewModel.pickupCollection(),o),ko.mapping.fromJS(viewModel.pickupCollection,viewModel.pickupCollection)),u=gPickupUpdateBackups,f=u.length;f--;)if(l=u[f].PickupNumber(),u[f].PickupNumber()===t){for(r=ko.mapping.fromJS(ko.mapping.toJS(u[f])),n.LocationName(r.LocationName()),n.Destination(r.Destination()),n.Rep(r.Rep()),n.Manager(r.Manager()),n.Status(r.Status()),n.TransporterName(r.TransporterName()),n.Notes(r.Notes()),n.Mode(r.Mode()),n.LocationName(r.LocationName()),n.PickupNumber(r.PickupNumber()),n.TransporterName(r.TransporterName()),n.Rep(r.Rep()),n.Manager(r.Manager()),n.Account(r.Account()),n.ShipCode(r.ShipCode()),n.Team(r.Team()),n.Contact(r.Contact()),n.Fax(r.Fax()),n.CreatedBy(r.CreatedBy()),n.Created(r.Created()),n.Closed(r.Closed()),n.ClosedBy(r.ClosedBy()),n.CancelledBy(r.CancelledBy()),n.Cancelled(r.Cancelled()),n.LastModified(r.LastModified()),n.Notes(r.Notes()),n.SortOrder(r.SortOrder()),n.Temp(r.Temp()),n.LastEditBy(r.LastEditBy()),n.Mode(r.Mode()),s=n.Items().length,h=r.Items().length,n.Items.splice(0,s),e=0;e<h;e++)c=r.Items()[e],n.Items.push(c);u.splice(f,1)}n.Mode("display");globalDisplayMode="display";globalUpdateType="update-cancelled";currentPickupUpdated=t;setTimeout(function(){formatAllDates();markUpdatedPickup(t,"cancel")},500)}})})}function activateDeleteItemButton(){$(document).on("click",".zfm-delete-item",null,function(){var n=ko.dataFor(this),i=n.PickupID(),r=$("tr[id="+i+"]"),t;r.animate({backgroundColor:"#C94040"},750).fadeOut(750,function(){});n.Qty("0");t=ko.utils.arrayFirst(viewModel.pickupCollection(),function(t){return t.PickupNumber()==n.PickupID()});ko.utils.arrayRemoveItem(t.Items(),n);ko.mapping.fromJS(viewModel.pickupCollection,viewModel.pickupCollection)})}function togleSoundAlerts(){var t=$("#toggleSoundIcon"),n=$("#soundAlert");audioALerts===!0?(n.fadeOut(500),audioALerts=!1,t.removeClass("fa-volume-up"),t.addClass("fa-volume-off"),n.removeClass("fa-volume-up"),n.addClass("fa-volume-off")):(audioALerts=!0,n.fadeIn(500),t.removeClass("fa-volume-off"),t.addClass("fa-volume-up"),n.removeClass("fa-volume-off"),n.addClass("fa-volume-up"));$(".navbar-collapse").removeClass("in");resizeNavNow()}function ViewAllPickupUdpdates(){var t=$("#toggleViewIcon"),n=$("#updateViewer");viewAllUpdates===!0?(n.fadeOut(500),viewAllUpdates=!1):(n.fadeIn(500),viewAllUpdates=!0);$(".navbar-collapse").collapse("hide");resizeNavNow()}function activateAddItemButton(){$(document).on("click",".zfm-addPhoto",null,function(){var n=ko.dataFor(this),t=$("#currentUserInfo").attr("data-fullname"),i={ID:ko.observable("0"),Description:ko.observable("PHOTO UPLOAD"),Qty:ko.observable("1"),Notes:ko.observable(""),PickupID:ko.observable(n.ID()),PickupReff:ko.observable(n.PickupNumber()),AddedBy:ko.observable(t),AddedDate:ko.observable(moment(new Date).format("l  LT")),Picture1:ko.observable("none"),Picture2:ko.observable("")};n.Items().push(i);ko.mapping.fromJS(viewModel.pickupCollection,viewModel.pickupCollection)})}function activateAddPickupButton(){var t,n,r,i,u;$(".navbar-collapse").collapse("hide");resizeNavNow();t=$("#currentUserInfo").attr("data-fullname");n=$("#currentUserInfo").attr("data-teamname");(n==="Courier"||n==="Warehouse")&&(n="");i=$("#currentUserInfo").attr("data-userrole").toLocaleLowerCase();r=i.indexOf("courier")>=0||i.indexOf("warehouse")>=0?"editAdmin":"edit";u={ID:ko.observable("NEW"),PickupNumber:ko.observable("NEW"),LocationName:ko.observable(""),Destination:ko.observable(""),TransporterName:ko.observable(""),Rep:ko.observable(""),Manager:ko.observable(""),Account:ko.observable(""),ShipCode:ko.observable(""),Team:ko.observable(n),Contact:ko.observable(""),Phone:ko.observable(""),Fax:ko.observable(""),CreatedBy:ko.observable(t),Created:ko.observable(moment(new Date).format("l  LT")),Closed:ko.observable(""),Status:ko.observable("OPEN"),ClosedBy:ko.observable(""),CancelledBy:ko.observable(""),Cancelled:ko.observable(""),LastModified:ko.observable(moment(new Date).format("l  LT")),Notes:ko.observable(""),SortOrder:ko.observable(""),Temp:ko.observable(""),LastEditBy:ko.observable(t),Mode:ko.observable(r),Items:ko.observableArray()};globalDisplayMode="edit";viewModel.pickupCollection.unshift(u);ko.mapping.fromJS(viewModel.pickupCollection,viewModel.pickupCollection);$("html,body").animate({scrollTop:1},1e3);setTimeout(function(){formatAllDates();iOSNavBarInputfix()},250)}function activateRemovePickupButton(){$(document).on("click",".zfm-delete",null,function(){var n=ko.dataFor(this),i=$("#currentUserInfo").attr("data-fullname"),u=$("#currentUserInfo").attr("data-teamname"),t=$("#currentUserInfo").attr("data-userrole"),r=n.CreatedBy();i===r||t==="Courier Admin"||t==="Team Admin"||t==="Warehouse Admin"||t==="Warehouse"||t==="Courier"?bootbox.dialog({message:"<input id='pinCode' class='bootbox-input bootbox-input-text form-control' autocomplete='off' type='password'><\/input><span id='passmsg' style='font-size: large; color: lightcoral' class='blink-now' ><\/span>",title:"<h4>PIN CODE TO REMOVE PICKUP #: <h3 style='color: orangered; text-align: center;' >"+n.PickupNumber()+"<\/h3> <\/h4>",closeButton:!1,buttons:{accept:{label:"REMOVE",className:"btn-primary btn-danger",callback:function(){var t=$("#pinCode").val(),i=n.PickupNumber();if(globalCurrentUserPin===t)removePickup(n.PickupNumber());else return $("#passmsg").text("PIN CODE NOT VALID. TRY AGAIN OR CANCEL TO DISMISS."),$("#pinCode").val(""),!1}},cancel:{label:"CANCEL",className:"btn-default",callback:function(){}}}}):bootbox.alert("<h3>YOU DO NOT HAVE PERMISSION TO REMOVE PICKUP #: <p style='color: darkOrange; text-align: center; margin-top:5px' > "+n.PickupNumber()+"<\/p><\/h3>")})}function activateUpdateButton(){$(document).on("click",".zfm-update",null,function(){var n=ko.dataFor(this),r=n.Items,t=n.PickupNumber();bootbox.confirm("<h3>Update Pickup #: <span style='color: darkOrange'>"+t+"<\/span>?<\/h3>",function(u){var f,e,o;if(u===!0){for(searchInput=r,i=searchInput().length;i--;)f=searchInput()[i].Qty(),e=searchInput()[i].Description(),(f===""||e==="")&&searchInput.splice(i,1);n.Mode("display");globalDisplayMode="display";globalUpdateType="pickup_updated";currentPickupUpdated=t;o=ko.mapping.toJS(n);$.ajax({type:"POST",contentType:"application/json",url:"/Pickup/UpdatePickup",data:JSON.stringify(o)}).done(function(n){var t=parseFloat(n);isNaN(t)||(currentPickupUpdated=t,getPickups())}).complete(function(){console.log("Updated Pickup "+currentPickupUpdated+" on server");globalDisplayMode="display";searchPickupsNow()}).error(function(){alert("ERROR Saving Pickup #:  to server.")})}})})}function activateHelpButton(){$(".navbar-collapse").removeClass("in");resizeNavNow();$("#techSupport").modal("show")}function sendPhotos(){$(document).on("click",".zfm-send-photo",null,function(){var t=ko.dataFor(this);gPickupPhotoUpdate=t.PickupNumber();$("#photoUpload").modal("show");$("#numberOfpics").text(" "+gTotalNumberOfPhotos+" ");gTotalNumberOfPhotos===1?$("#singleOrmore").text(" PHOTO "):$("#singleOrmore").text(" PHOTOS ");$("#photoUploadSize").text(filesize(gTotalPhotosSize));$("#photoUploadSpeed").text(webSpeed.toLocaleUpperCase());var i=document.getElementById("photos"),r=new FormData(i),n=new XMLHttpRequest;n.upload.addEventListener("loadstart",onloadstartHandler,!1);n.upload.addEventListener("progress",onprogressHandler,!1);n.upload.addEventListener("load",onloadHandler,!1);n.addEventListener("readystatechange",onreadystatechangeHandler,!1);n.open("POST","/Pickup/Files",!0);n.send(r)})}function onloadstartHandler(){console.log("Upload started!")}function onloadHandler(){allPhotos=0;numberOfPhotos=0;lastPhotoName="";localStorage.setItem("pickupPhotoUpate",gPickupPhotoUpdate);console.log("Upload successful!");document.location.href="/Pickup"}function onprogressHandler(n){var i=document.getElementById("uploadProgress"),t;i!==null&&(t=Math.round(n.loaded/n.total*100),i.innerHTML=t+"%",i.style.width=t+"%",console.log("Progress: "+t+"%"))}function onreadystatechangeHandler(n){var t=null;try{t=n.target.status}catch(i){return}t=="200"&&n.target.responseText&&console.log("The server saw it as: "+n.target.responseText)}function checkFileB4Uoload(){$(document).on("change",":file",function(n){gTotalPhotosSize=0;gTotalNumberOfPhotos=0;$.each($("input[type='file']"),function(){var t=this.files[0],r,u;if(t===null)return!0;var f=t.name,i=t.size,e=t.type;i>1&&(gTotalPhotosSize>gTotalPhotosLimit&&bootbox.alert("<h3>PHOTO SIZE LIMIT DETECTED:<\/h3> <\/br><span style='text-align: center; font-size: x-large; display: block;'><span style='width: auto; text-align: center; color: orangered;'>"+filesize(gTotalPhotoSize)+" USED: <\/span><span>LIMIT: 100MB <\/span><\/span><br/><h3> PLEASE SELECT ANOTHER PHOTO.<\/h3>",function(){return n.preventDefault(),n.stopPropagation(),!1}),gTotalPhotosSize=gTotalPhotosSize+i,gTotalNumberOfPhotos++,r=this,u=$(this).parent(),$(u).text(f).prepend(r))})})}function displayPhoto(){$(document).on("click",".zfm-display-photo",null,function(){var n=ko.dataFor(this);n.Picture1()!=="none"&&($("#imgView").attr("src",n.Picture1()),$("#myModalLabel").text("PICKUP #: "+n.PickupID()+"  [ "+n.Qty()+" - "+n.Description()+" ]"),$("#picModal").modal("show"))})}function rotatePhoto(){$(document).on("click",".btn-rotate-photo",null,function(){gRotation+=90;$("#imgView").rotate({animateTo:gRotation})})}function scrollAfterPhotoUpload(){var n=localStorage.getItem("pickupPhotoUpate");n!==null&&setTimeout(function(){markUpdatedPickup(n,"photo_uploaded");localStorage.removeItem("pickupPhotoUpate")},1e3)}function doneRenderingItem(){gPickupsRendered++;console.log("Number of Pickups Rendered: "+gPickupsRendered);console.log("Rendering Flag set to: "+gFinishedRendering);gFinishedRendering===!0&&(gFinishedRendering=!1);var n=$("#currentUserInfo").attr("data-fullname"),t=$(".panel-primary").length,i=$(".loc-typeahead").length,r=$(".item-typeahead").length,u=$(".rep-typeahead").length,f=$(".courier-typeahead").length,e=$(".status-typeahead").length,o=$(".warehouse-typeahead").length,s=$(".teams-typeahead").length,h=$(".des-typeahead").length,c=$(":file").length;if($("numberOfPickups").text(gPickupsRendered),c>0&&checkFileB4Uoload(),i>0&&(lookupTypeahead(),formatAllDates()),h>0&&(destinationTypeahead(),formatAllDates()),u>0&&(repsTypeahead(),formatAllDates()),r>0&&(itemsTypeahead(),formatAllDates()),f>0&&(courierTypeahead(),formatAllDates()),e>0&&(statusTypeahead(),formatAllDates()),o>0&&(warehouseTypeahead(),formatAllDates()),s>0&&(teamsTypeahead(),formatAllDates()),t===globaltotalPickups){if(console.log("Last Item Rendered: "+gPickupsRendered),gFinishedRendering===!1&&(gFinishedRendering=!0),console.log("Redering Flag set to: "+gFinishedRendering),gPickupsRendered=0,console.log("Item Counter reset to: "+gPickupsRendered),gFinishedRendering&&currentPickupUpdated!==lastUpdatedPickup&&globalUpdateType===""&&n!==lastUpdateby&&(lastUpdatedPickup=currentPickupUpdated,markUpdatedPickup(currentPickupUpdated,"yes","pickup_updated"),console.log("Done Rendering! Last Pickup updated: "+currentPickupUpdated)),gFinishedRendering&&currentPickupUpdated===lastUpdatedPickup&&globalUpdateType===""){if(typeof currentPickupUpdated=="undefined"||typeof lastUpdatedPickup=="undefined")return;if(globalDisplayMode==="edit")return;markUpdatedPickup(currentPickupUpdated,"pickup_updated")}if(globalUpdateType==="pickup_updated"&&typeof currentPickupUpdated!="undefined"){if(globalDisplayMode==="edit")return;markUpdatedPickup(currentPickupUpdated,globalUpdateType);globalUpdateType=""}}}function markUpdatedPickup(n,t){var i,r;(console.log("Mark Pickup For "+n+" called..."),i=$("#alert"+n),i.length!==0)&&viewAllUpdates===!0&&(r="#pu"+n,$.when(scrollToID(r,250)).then(markPickup(i)).then(playSound(t)))}function lookupTypeahead(){var n=$(".loc-typeahead");$(".loc-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(n){var t=n+"-location";return{search:t}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}});console.log("Location autocomplete call finished.")}function destinationTypeahead(){var n=$(".des-typeahead");$(".des-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(n){var t=n+"-destination";return{search:t}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}});console.log("Location autocomplete call finished.")}function itemsTypeahead(){$("#SearchAgent").typeahead({ajax:"/Pickup/LocationTypeahead"});var n=$(".item-typeahead");$(".item-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(n){var t=n+"-items";return{search:t}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}});console.log("Items autocomplete call finished.")}function repsTypeahead(){var t=$(".rep-typeahead"),n=$("#currentUserInfo").attr("data-teamname");$(".rep-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(t){var i=t+"-reps-"+n;return{search:i}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}});console.log("Reps autocomplete call finished.")}function courierTypeahead(){var t=$(".courier-typeahead"),n=$("#currentUserInfo").attr("data-teamname");$(".courier-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(t){var i=t+"-couriers-"+n;return{search:i}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}})}function statusTypeahead(){var t=$(".status-typeahead"),n=$("#currentUserInfo").attr("data-teamname");$(".status-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(t){var i=t+"-status-"+n;return{search:i}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}})}function warehouseTypeahead(){var t=$(".warehouse-typeahead"),n=$("#currentUserInfo").attr("data-teamname");$(".warehouse-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(t){var i=t+"-warehouse-"+n;return{search:i}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}})}function teamsTypeahead(){var t=$(".teams-typeahead"),n=$("#currentUserInfo").attr("data-teamname");$(".teams-typeahead").typeahead({ajax:{url:"/Pickup/SearchAgent",timeout:100,contentType:"application/json",triggerLength:2,dataType:"json",traditional:!0,method:"get",loadingClass:"loading-wait",preDispatch:function(t){var i=t+"-teams-"+n;return{search:i}},preProcess:function(n){return n.success===!1||n.length==0?!1:(typeaheadSource=[],$(n).each(function(n,t){typeaheadSource[n]=t.label}),typeaheadSource)}}})}function clearPickup(n){n.nodeType===1&&($(n).slideUp("slow",function(){$(n).remove()}),console.log("Hide Pickup Called"))}function showPickup(n){n.nodeType===1&&$(n).hide().slideDown("slow");console.log("Show Pickup Called")}function resizeNavNow(){setTimeout(function(){var n=$(".navbar").height()+10;$("body").animate({"padding-top":n+"px"},500,function(){})},100)}function autoSizeBody2NavBar(){$(".navbar").on("shown.bs.collapse",function(){setTimeout(function(){var n=$(".navbar").height()+10;$("body").animate({"padding-top":n+"px"},500,function(){})},250)});$(".navbar").on("hidden.bs.collapse",function(){setTimeout(function(){var n=$(".navbar").height()+10;$("body").animate({"padding-top":n+"px"},500,function(){})},250)})}function priorityAlert(){$(".status-field").each(function(){var n=$(this).text().toLocaleLowerCase();n.indexOf("priority")>=0&&$(this).addClass("blink-now priority-status").removeClass("pickup-item-headers-2").text(n.toUpperCase())});console.log("Check for priority status complete.")}function convertLocTile2Uppercase(){$(".location-name-title, .destination-name-title").each(function(){var n=$(this).text();n=n.toUpperCase();$(this).text(n)});console.log("Convert Location to upper case complete.")}function toggleFieldLabels(){$(".navbar-collapse").removeClass("in");resizeNavNow();$(".field-label").each(function(){var n=$(this).css("display");n==="none"?($(this).show("slow"),localStorage.setItem("showLabels","yes")):($(this).hide("slow"),localStorage.setItem("showLabels","no"))});console.log("Convert Location to upper case complete.")}function formatAllDates(){$(".date-field").each(function(){var t=$(this).text(),i=$(window).width(),n;if(i>738){if(n=moment(t).format("M-D-YY LT"),n==="Invalid date")return!0;$(this).text(n)}else{if(n=moment(t).format("M-D-YY h:mma"),n==="Invalid date")return!0;$(this).text(n)}});console.log("Format all dates complete.")}function webConnection(n){switch(n){default:case"high":$("#iStatus").removeClass();$("#iStatus").addClass("internet-high-speed");break;case"medium":$("#iStatus").removeClass();$("#iStatus").addClass("internet-medium-speed");break;case"off":$("#iStatus").removeClass();$("#iStatus").addClass("internet-disconnected")}}function getUsername(){return $("#userName").attr("data-username")}function orientationFix4iOS(){navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&$(window).resize(function(){var i=$(window).width(),n=$(window).height(),t=$(window).width();t>n?(gviewMode="landscape",setTimeout(function(){$(window).scrollTop($(window).scrollTop()+1)},10)):(gviewMode="portrait",setTimeout(function(){$(window).scrollTop($(window).scrollTop()+1)},50))})}function saveAppleinfo(){var n=$("#currentUserInfo").attr("data-username"),t=$("#currentUserInfo").attr("data-code"),i=$("#currentUserInfo").attr("data-codeexp");localStorage.setItem("name",n);localStorage.setItem("code",t);localStorage.setItem("exp",i)}function logUserOut(){localStorage.removeItem("name");localStorage.removeItem("code");localStorage.removeItem("exp");document.getElementById("logoutForm").submit()}function decryptCypher(n){var t;$.ajax({url:"/Pickup/Decode",cache:!1,type:"GET",data:{cypher:n},success:function(n){t=n.answer;globalCurrentUserPin=t}})}function scrollToID(n,t,i){if(console.log("Scroll function for  Pickup "+n+" called..."),gFinishedRendering===!1){console.log("Waiting for Rendering to finish. Pickup to process when ready:"+n);setTimeout(scrollToID(n,t,i),500);return}setTimeout(function(){var f,e,r,u;($(".navbar-collapse").removeClass("in"),resizeNavNow(),f=$("#NEW"),i!=="go"&&globalDisplayMode==="edit"||f.length>0)||(e=$(".navbar").height(),r=$(n),r.length>0&&(u=$(r).offset().top-e,typeof u!="undefined"&&$("html,body").animate({scrollTop:u},t)))},1500)}function markPickup(n){console.log("Highlight Pickup function called...");var t="rgb("+Math.floor(Math.random()*256)+","+Math.floor(Math.random()*256)+","+Math.floor(Math.random()*256)+")",i=t,r=n.css("backgroundColor");n.stop().css("background-color",i).animate({backgroundColor:r},3e3)}function playSound(n){audioALerts===!0&&($.ionSound.play(n),console.log("Played Sound: "+n+" for Pickup #: "+currentPickupUpdated));currentPickupUpdated=""}function initilizeSound(){$.ionSound({sounds:["pickup_updated","pickup_deleted","photo_uploaded","pickup_completed","priority_pickup","self_update","cancel","alert"],path:"/Content/sounds/",multiPlay:!1,volume:"1"})}function CheckPictureUpdate(){setTimeout(function(){var r=$("#currentUserInfo").attr("data-goto"),n=parseFloat(r),t,i;isNaN(n)||(t="#"+n,scrollToID(t,1e3),audioALerts===!0&&$.ionSound.play("photo_uploaded"),i={"z-trak":!0},history.pushState(i,"Z-Trak","/Pickup"))},2e3)}function iOSNavBarInputfix(){if(navigator.userAgent.match(/(iPod|iPhone|iPad)/)){$(document).on("blur",".ios",function(){var n=$(".navbar").css("display");n==="none"&&$(".navbar").css("display","block")});$(document).on("focus",".ios",function(){var n=$(".navbar").css("display");n!=="none"&&$(".navbar").css("display","none")})}}function getUrlParameter(n){for(var i,u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return i[1]}function searchPickupsNow(){var n=$("#searchFilter").val(),t;n.length>0?($("#searchSign").show().attr("title","Searching for: "+n),$("#pickupsContainer li:not(.item-line)").hide().filter(function(){return $(this).text().toLowerCase().indexOf($("#searchFilter").val().toLowerCase())!==-1}).show(),t=$(".panel-primary").length,$("#numberOfPickups:visible").val(t)):$("#searchSign").hide()}function searchPickupsBox(){$("#searchFilter").on("keyup click input",function(){if(this.value.length>0){$("#pickupsContainer li:not(.item-line)").hide().filter(function(){return $("#searchSign").show().attr("title","Searching for: "+$("#searchFilter").val()),$(this).text().toLowerCase().indexOf($("#searchFilter").val().toLowerCase())!==-1}).show();var n=$(".panel-primary:visible").length;console.log("Pickups found with criteria: "+$("#searchFilter").val()+" = "+n);$("#numberOfPickups").text(n)}else $("#pickupsContainer li").show(),$("#searchSign").hide()})}function activateSearchButton(){var t=$("#searchFilter").val(),n;$(".zfm-search-bar").is(":visible")?($(".zfm-search-bar").fadeOut("slow",function(){setTimeout(function(){var n=$(".navbar").height()+10;$("body").animate({"padding-top":n+"px"},500,function(){})},100)}),t.length>0&&($("#searchFilter").val(""),$("#pickupsContainer li:not(.item-line)").hide().filter(function(){return $(this).text().toLowerCase().indexOf($("#searchFilter").val().toLowerCase())!==-1}).show(),n=$(".panel-primary").length,console.log("Pickups found  = "+n),$("#numberOfPickups").text(n),$("#searchSign").hide())):$(".zfm-search-bar").fadeIn("slow",function(){setTimeout(function(){var n=$(".navbar").height()+10;$("body").animate({"padding-top":n+"px"},500,function(){})},100)})}function enablePopOvers(){$(".info-menu").popover("destroy");setTimeout(function(){$(".info-menu").popover()},500)}function seconds_elapsed(){var n=new Date,t=n.getTime(),i=t-startTime;return Math.floor(i/1e3)}function time_spent(){var n=seconds_elapsed(),t=Math.floor(n/60),r,i;n-=t*60;r=Math.floor(t/60);t-=r*60;i="";i=n>0?n:"-";t>0&&(i=t+":"+n);r>0&&(i=r+":"+t+":"+n);$("#timeElapsed").html(i);setTimeout("time_spent ()",1e4)}function pad(n){return n>9?n:"0"+n}function resetElapsedTimer(){startDate=new Date;startTime=startDate.getTime();$("#timeElapsed").html("-")}function webConnType(){var n=$("#webTransportType");setTimeout(function(){$.connection.hub.transport.name==="webSockets"?(webSpeed="fast",n.text("F").attr("title","Fast Internet Detected")):$.connection.hub.transport.name==="forverFrame"?(webSpeed="ie",n.text("S3").attr("title","Medium Internet Speed Detected - Internet Explorer")):$.connection.hub.transport.name==="serverSentEvents"?(webSpeed="ss",n.text("S2").attr("title","Slow Internet Speed Detected")):$.connection.hub.transport.name==="longPolling"&&(webSpeed="slow",n.text("S1").attr("title","Slow Internet Speed Detected - LP"))},5e3)}function Library(){var r=ko.mapping.fromJS(ko.mapping.toJS(n)),n=ko.dataFor(this),r=ko.mapping.fromJS(ko.mapping.toJS(n)),t,i,u,f;for(gPickupUpdateBackups.push(r),t=currentItems,i=t.length;i--;)u=t()[i].Qty(),f=t()[i].Description(),t()[i].Qty()==""&&t.splice(i,1);bootbox.confirm("<h3>Cancel Changes?<\/h3>",function(t){var r,u,h,i,e,o,f,s;if(t===!0){for(r=gPickupUpdateBackups,u=r.length;u--;)if(h=r[u].PickupNumber(),r[u].PickupNumber()===pickupID){for(i=ko.mapping.fromJS(ko.mapping.toJS(r[u])),n.LocationName(i.LocationName()),n.Rep(i.Rep()),n.Manager(i.Manager()),n.Status(i.Status()),n.TransporterName(i.TransporterName()),n.Notes(i.Notes()),n.Mode(i.Mode()),n.LocationID(i.LocationID()),n.LocationName(i.LocationName()),n.ID(i.PickupNumber()),n.TransporterID(i.TransporterID()),n.TransporterName(i.TransporterName()),n.Rep(i.Rep()),n.Manager(i.Manager()),n.Account(i.Account()),n.ShipCode(i.ShipCode()),n.Team(i.Team()),n.Contact(i.Contact()),n.Fax(i.Fax()),n.CreatedBy(i.CreatedBy()),n.Created(i.Created()),n.Closed(i.Closed()),n.ClosedBy(i.ClosedBy()),n.CancelledBy(i.CancelledBy()),n.Cancelled(i.Cancelled()),n.LastModified(i.LastModified()),n.Notes(i.Notes()),n.SortOrder(i.SortOrder()),n.Temp(i.Temp()),n.LastEditBy(i.LastEditBy()),n.Mode(i.Mode()),e=n.Items().length,o=i.Items().length,n.Items.splice(0,e),f=0;f<o;f++)s=i.Items()[f],n.Items.push(s);r.splice(u,1)}n.Mode("display");globalDisplayMode="display";globalUpdateType="update-cancelled";currentPickupUpdated=pickupID;setTimeout(function(){formatAllDates();markUpdatedPickup(pickupID,"yes","cancel")},500)}})}var startDate=new Date,startTime=startDate.getTime(),iOSinit=!1,currentPickupUpdated,lastUpdateby,lastUpdatedPickup,globaltotalPickups=0,globalTotalItems=0,gPickupsRendered=0,webSpeed="NA",webAppmode="false",typeaheadSource=["John","Alex","Terry"],globalCurrentUserPin,viewAllUpdates=!0,audioALerts=!0,globalDisplayMode,gViewmodelChanged=!1,gRotation=0,gviewMode="portrait",gPickupUpdateBackups=[],globalUpdateType="",gDataRequest,gFinishedRendering=!1,gTotalPhotosSize=0,gTotalPhotosLimit=103809024,gTotalNumberOfPhotos=0,gPickupPhotoUpdate,map=null,infobox,dataLayer,customInfobox,locSearchResult,activePickups=null,pickupChannel=$.connection.pickupHub,viewModel;$.connection.hub.start();$.connection.hub.start().done(function(){setTimeout(function(){webConnType();joinGroup()},5e3);$.connection.hub.transport.name!=="webSockets"&&(intervalHandle=setInterval(function(){var t=$("#currentUserInfo").attr("data-fullname"),n;$.connection.hub.state===$.signalR.connectionState.connected&&(n=moment(new Date).format("l  LT"),pickupChannel.server.ping(t).fail(function(){$("#webTransportType").text("NA").attr("title","No Internet Connection Detected - Last Server Check: "+n);$("#webTransportType").addClass("blink-now");console.log("Pickup Hub Ping Failed at: "+new Date)}).done(function(){$("#webTransportType").text("S4").attr("title","Slow Internet Speed Detected - Last Server Check: "+n);$("#webTransportType").removeClass("blink-now");console.log("Pickup Hub Ping at: "+new Date)}));console.log("pickupChannel ping interval of 30 seconds started. ")},3e5));$.connection.hub.transport.name=="webSockets"&&(intervalHandle=setInterval(function(){var t=$("#currentUserInfo").attr("data-fullname"),n;$.connection.hub.state===$.signalR.connectionState.connected&&(n=moment(new Date).format("l  LT"),pickupChannel.server.ping(t).fail(function(){$("#webTransportType").addClass("blink-now").css("color","red");$("#webTransportType").text("NIC").attr("title","No Internet Connection Detected - Last Server Check: "+n);console.log("Pickup Hub Ping Failed at: "+new Date)}).done(function(){$("#webTransportType").attr("data-content","Slow Internet Speed Detected - Last Server Check: "+n);$("#webstatNV").removeClass("blink-now");console.log("Pickup Hub Last Ping completed at: "+new Date)}));console.log("Pickup Channel ping interval of 30 seconds started. ")},3e4));console.log("pickupChannel started. ")});$.connection.hub.disconnected(function(){if(typeof intervalHandle!="undefined"){clearInterval(intervalHandle);var n=moment(new Date).format("l  LT");$("#webTransportType").addClass("blink-now").css("color","red");$("#webTransportType").text("NIC");$("#webspeedNB").attr("data-title","No Internet Connection Detected - Last Server Check: "+n);console.log("Pickup Hub Disconnected at: "+new Date);setTimeout(function(){$.connection.hub.start().done(function(){var n=moment(new Date).format("l  LT");$("#webTransportType").removeClass("blink-now").css("color","darkblue");$("#webTransportType").text("IR");$("#webspeedNB").attr("data-title","Internet Connection Restored at: "+n);console.log("Internet Reconnection successful at: "+n);enablePopOvers();getPickups()});console.log("Pickup Hub trying to reconnect at: "+new Date)},5e3)}});$.connection.hub.reconnected(function(){var n=moment(new Date).format("l  LT");$("#webTransportType").removeClass("blink-now").css("color","darkblue");$("#webTransportType").text("IR").attr("title","Internet Connection Restored at: "+n);console.log("Internet Reconnection successful at: "+n)});$.connection.hub.connectionSlow(function(){var n=moment(new Date).format("l  LT"),t=$("#webTransportType");t.text("CS").attr("title","We are currently experiencing difficulties with the connection - Last Server Check: "+n);console.log("We are currently experiencing difficulties with the connection.")});$.connection.hub.reconnecting(function(){console.log("Pickup Hub trying to reconnect at: "+new Date)});pickupChannel.client.webSpeed=function(n){webSpeed=n;console.log("Web Speed Reported: "+webSpeed)};pickupChannel.client.newDataUpdate=function(n,t){if(globalDisplayMode!=="edit"){var i=$("#currentUserInfo").attr("data-fullname");pickupChannel.server.webTransport(i);console.debug("Server Data Updated by : "+n+" - Web transport: "+webSpeed+" - Server Update Needed.");getPickups();lastUpdateby=n;markUpdatedPickup(t,"self_update")}};pickupChannel.client.pickupRemoved=function(n,t){if(getPickups(),audioALerts===!0&&$.ionSound.play("pickup_deleted"),viewAllUpdates===!0){var i=bootbox.alert("<h3>PICKUP #: <span style='color: darkOrange; text-align: center; margin-top:5px' > "+t+"<\/span>  HAS BEEN REMOVED BY "+n.toUpperCase()+" <\/h3> ");setTimeout(function(){i.modal("hide")},3e3)}};pickupChannel.client.pingReceived=function(n){webConnType();console.log("Ping Received by server from: "+n+" - web speed: "+webSpeed)};viewModel={};$(document).ready(function(){var n=$("#currentUserInfo").attr("data-pincode");globalCurrentUserPin=decryptCypher(n);getPickups();startDate=new Date;startTime=startDate.getTime();time_spent();searchPickupsBox();saveAppleinfo();activateEditButton();activateUpdateButton();activateAddItemButton();activateDeleteItemButton();activateCancelButton();activateRemovePickupButton();activatePhototButton();displayPhoto();rotatePhoto();initilizeSound();CheckPictureUpdate();displayPhoto();bootbox.setDefaults({closeButton:!1});iOSNavBarInputfix();orientationFix4iOS();enablePopOvers();autoSizeBody2NavBar();activateFindLocationGPS();activateMapRefresh()});
/*
//# sourceMappingURL=zfm.min.js.map
*/